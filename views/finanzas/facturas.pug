extends ../layout 

block contenido
  .content-wrapper
    .content-header
      .container-fluid
        .row
          .col-12.col-sm-6.col-md-3
            .info-box
              span.info-box-icon.bg-info.elevation-1
                i.fas.fa-cog
              .info-box-content
                span.info-box-text CPU Traffic
                span.info-box-number
                  | 10
                  small %
          .col-12.col-sm-6.col-md-3
            .info-box.mb-3
              span.info-box-icon.bg-danger.elevation-1
                i.fas.fa-thumbs-up
              .info-box-content
                span.info-box-text Likes
                span.info-box-number 41,410
          .clearfix.hidden-md-up
          .col-12.col-sm-6.col-md-3
            .info-box.mb-3
              span.info-box-icon.bg-success.elevation-1
                i.fas.fa-shopping-cart
              .info-box-content
                span.info-box-text Sales
                span.info-box-number 760
          .col-12.col-sm-6.col-md-3
            .info-box.mb-3
              span.info-box-icon.bg-warning.elevation-1
                i.fas.fa-users
              .info-box-content
                span.info-box-text New Members
                span.info-box-number 2,000
        .row.mb-2
          .col-sm-6
            h1.m-0 Facturas
          .col-sm-6.text-right
            button.btn.btn-success(data-toggle="modal" data-target="#addFacturaModal") 
              i.fas.fa-plus
              |  Nueva Factura
        // /.row
      // /.container-fluid
    // /.content-header
    // Main content
    section.content
      .container-fluid
        table#facturasTable.table.table-striped
          thead
            tr
              th Fecha de Ingreso
              th Número
              th Proveedor
              th Monto
              th Estado de Pago
              th 
          tbody
            each factura, index in facturas
              tr
                td= factura.fecha_emision.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' })
                td= factura.numero_factura
                td= factura.proveedor.nombre_proveedor
                td= factura.monto
                td= factura.estado_pago ? 'Pagado' : 'Pendiente'
                td
                  button.btn.btn-primary.btn-sm.mx-2(data-toggle="modal" data-target=`#detalleModal${index}`) 
                    i.fas.fa-eye

                  // Modal de Detalles
                  .modal.fade(id=`detalleModal${index}` tabindex="-1" role="dialog")
                    .modal-dialog.modal-xl(role="document")
                      .modal-content
                        .modal-header
                          h5.modal-title Detalles de Factura - #{factura.numero_factura}
                          button.close(type="button" data-dismiss="modal" aria-label="Close")
                            span(aria-hidden="true") &times;
                        .modal-body
                          // Contenido del Modal de Detalles

      // Modal para Crear Nueva Factura
      .modal.fade#addFacturaModal(tabindex="-1" role="dialog")
        .modal-dialog.modal-lg(role="document")
          .modal-content
            .modal-header
              h5.modal-title Nueva Factura
              button.close(type="button" data-dismiss="modal" aria-label="Close")
                span(aria-hidden="true") &times;
            .modal-body
              form(action="/ruta/para/crear/factura" method="POST")
                .form-group
                  label(for="numero_factura") Número de Factura
                  input#numero_factura.form-control(type="text" name="numero_factura" required)
                .form-group
                  label(for="fecha_emision") Fecha de Emisión
                  input#fecha_emision.form-control(type="date" name="fecha_emision" required)
                .form-group
                  label(for="proveedor") Proveedor
                  select#proveedor.form-control(name="proveedor_id" required)
                    each proveedor in proveedores
                      option(value=proveedor.id)= proveedor.nombre_proveedor
                .form-group
                  label(for="monto") Monto
                  input#monto.form-control(type="number" step="0.01" name="monto" required)
                .form-group
                  label(for="estado_pago") Estado de Pago
                  select#estado_pago.form-control(name="estado_pago" required)
                    option(value="1") Pagado
                    option(value="0") Pendiente
                button.btn.btn-primary(type="submit") Guardar
            .modal-footer
              button.btn.btn-secondary(type="button" data-dismiss="modal") Cerrar

      // Scripts para DataTables y Bootstrap
      script(src="https://code.jquery.com/jquery-3.3.1.min.js")
      script(src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js")
      script(src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js")
      script(src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js")
      script.
        new DataTable('#facturasTable',{
          "language": {
            "url": "https://cdn.datatables.net/plug-ins/1.11.5/i18n/es-ES.json",
          }
        })
